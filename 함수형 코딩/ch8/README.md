## 챕터8

### 소프트웨어 설계란?
- 코드를 만들기
- 테스트 하기
- 유지보수 하기
위의 세가지를 하기 쉬운 프로그래밍 방법을 선택하기 위해 미적 감각을 사용하는 것.

이 장에서는 계층형 설계라는게 나온다.

### 계층형 설계?
- 소프트웨어를 계층으로 구성하는 기술
- 각 계층에 있는 함수는 바로 아래 계층에 있는 함수를 이용해 정의

우리가 이전 장들에서 배웠던 것들이 계층을 이루기 위한 초석이었다!
계층형 설계 예)
- 비즈니스 규칙
- 장바구니를 위한 동작들
- 카피-온-라이트
- JS에서 지원하는 배열 관련 기능

#### 각 계층을 정확히 구분하기는 어렵다.
계층을 잘 구분하기 위해서는 다양한 변수를 찾고 어떻게 해야 하는지 알아야 한다.

#### 좋은 설계를 하는 방법은?
이 장에서 코드를 읽을 때 더 좋은 설계를 알려주는 신호를 찾는 법을 배운다


### 설계 감각 키우기
#### 전문가의 저주
전문가는 어떤 것을 알지만 정확히 설명하지는 못한다.
블랙박스를 설명하는 것과 같기 때문이다. 블랙 박스는 복잡하고 다양한 입력을 받아 복잡하고 다양한 결과를 만들기 때문.

#### 계층형 설계 감각을 키우기 위한 입력
아래의 것들은 계층형 설계의 단서가 된다.
함수본문
- 길이
- 복잡성
- 구체화 단계
- 함수 호출
- 프로그래밍 언어의 기능 사용

계층구조
- 화살표 길이
- 응집도
- 구체화 단계

함수 시그니쳐
- 함수명
- 인자 이름
- 인잣값
- 리턴 값

##### 계층형 설계 감각을 키우기 위한 출력
입력으로 할 수 있는 일은 다양하다.
조직화
- 새로운 함수를 어디에 놓을지 결정
- 함수를 다른 곳으로 이동

구현
- 구현 바꾸기
- 함수 추출하기
- 데이터 구조 바꾸기

변경
- 새 코드를 작성할 곳 선택하기
- 적절한 수준의 구체화 단계 결정하기

### 계층형 설계 패턴
- 직접 구현
  - 함수 시그니쳐가 풀어야할 문제를 함수 본문에서 적절한 구체화 수준에서 해결해야한다.
  - 너무 구체적이면 코드에서 냄새가 난다.
- 추상화 벽
  - 세부 구현을 감추고 인터페이스를 제공한다.
  - 추상화 단계만 생각하면 되기 때문에 두뇌 용량 한계 극복가능
- 작은 인터페이스
  - 시스템이 커질수록 인터페이스는 작고 강력하게 동작하도록 한다.
  - 다른 동작도 직간접적으로 최소한의 인터페이스를 유지하면서 정의해야한다.
- 편리한 계층
  - 계층형 설계 패턴과 실천 방법은 개발자의 요구와 비즈니스 문제를 잘 풀 수 있어야 한다.
  - 그냥 좋아서 계층을 추가하기보다는 더 빠르고 고품질로 제공하는데 도움이 되는 계층에 시간을 투자해야 함.





### 패턴 1 직접구현
직접 구현에서는 가 함수들을 계층형 다이어그램으로 표현해서 평탄화 작업을 하는 것만 같았다.
함수를 계층으로 나눌 때, 함수가 늘어나서 더 복잡해질 줄 알았지만 오히려 함수안에서 반복되는 코드를 줄이는 효과가 있었다.
먼저 각 함수안에서 호출되는 것들이 언어레벨인지 함수호출인지 등에 따라 코드를 더 세분화시켜함수를 나눌 수 있다.
세분화시킴으로써 코드를 재활용할 수도 있었다.

#### 호출 그래프를 만들어 함수 호출 시각화
- 하나의 함수 안에 언어게벨의 기능(반복문 if문)을 하는 블록
- 함수 호출

두 가지가 일어나고 있다면 같은 추상화 레벨로 더 세분화 시킨다.
바로 호출 그래프를 그려서 함수의 세부 기능들을 계층으로 바라볼 수 있다.
함수 안에서 호출되는 함수들을 같은 게층으로 만든다.


#### 같은 계층 안에 있는 함수들은 같은 목적을 가져야 한다.
각 계층의 목적을 나눈다.
예를들어 
- 장바구니의 비즈니스 규칙
- 일반적인 비즈니스 규칙
- 장바구니 기본 동작
- 제품에 대한 기본 동작
- 카피온라이트동작
- 자바스크립트 언어기능

으로 각 계층을 나눔으로써 더 높은 차원에서 함수들을 바라볼 수 있다.


#### 요점
- 계층형 설계는 코드를 추상화 계층으로 구성한다
- 함수 구현 시 어던 구체화 단계로 쓸지 결정한다.
- 함수 호출 그래프, 함수이름으로 함수가 어떤 계층에 속할지 알 수 있다.
- 함수 이름은 함수의 의도를 알려주기 때문에 비슷한 목적의 이름을 가진 함수를 함께 묶을 수 있다.


